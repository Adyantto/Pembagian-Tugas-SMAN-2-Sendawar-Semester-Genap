<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Lampiran SK Pembagian Tugas Guru</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:"Times New Roman", serif;
  background:#e5e7eb;
}

/* HALAMAN A4 */
.page{
  width:210mm;
  min-height:297mm;
  background:#fff;
  margin:20px auto;
  padding:20mm;
  box-shadow:0 0 10px rgba(0,0,0,.2);
}

/* KOP */
.kop img{
  width:100%;
  margin-bottom:14px;
}

/* JUDUL */
.judul{
  text-align:center;
  margin-bottom:16px;
}
.judul h3{
  margin:6px 0;
  text-decoration:underline;
}
.judul p{
  margin:2px 0;
  font-size:12pt;
}

/* IDENTITAS */
.identitas{
  margin-bottom:12px;
}
.identitas table td{
  padding:3px 0;
  font-size:12pt;
}

/* TABEL */
table{
  width:100%;
  border-collapse:collapse;
  font-size:12pt;
}
th, td{
  border:1px solid #000;
  padding:6px;
}
th{
  text-align:center;
}

/* SUBTOTAL */
.subtotal{
  margin-top:10px;
  font-weight:bold;
  font-size:12pt;
}

/* TTD */
.ttd{
  margin-top:40px;
  width:100%;
}
.ttd .kanan{
  width:40%;
  float:right;
  text-align:center;
}
.clear{ clear:both }

/* CETAK */
@media print{
  body{ background:#fff }
  .page{
    margin:0;
    box-shadow:none;
  }
}
</style>
</head>

<body>

<div class="page">

  <!-- KOP -->
  <div class="kop">
    <img src="KOP SEKOLAH.png" alt="KOP SEKOLAH">
  </div>

  <!-- JUDUL -->
  <div class="judul">
    <h3>LAMPIRAN SURAT KEPUTUSAN</h3>
    <p>Nomor : 400.3.8/ __________ /SMAN 2 SDWR/2025</p>
    <p>Tentang Pembagian Tugas Guru</p>
    <p>Semester Genap Tahun Pelajaran 2025 / 2026</p>
  </div>

  <!-- IDENTITAS -->
  <div class="identitas">
    <table>
      <tr>
        <td width="30%">Nama Guru</td>
        <td width="5%">:</td>
        <td id="namaGuru">-</td>
      </tr>
      <tr>
        <td>NIP</td>
        <td>:</td>
        <td id="nipGuru">-</td>
      </tr>
    </table>
  </div>

  <!-- TABEL -->
  <table>
    <thead>
      <tr>
        <th width="5%">No</th>
        <th width="18%">Jenis Tugas</th>
        <th width="37%">Uraian Tugas</th>
        <th width="25%">Kelas</th>
        <th width="10%">JP</th>
      </tr>
    </thead>
    <tbody id="tabelTugas"></tbody>
  </table>

  <!-- SUBTOTAL -->
  <div class="subtotal" id="subtotalJP"></div>

  <!-- TTD -->
  <div class="ttd">
    <div class="kanan">
      <p>Sendawar, 5 Januari 2026</p>
      <p>Kepala SMA Negeri 2 Sendawar</p>
      <br><br><br>
      <p><b>Fardinandus Erikson, S.Fil</b><br>
      NIP. 19691010 200801 1 026</p>
    </div>
    <div class="clear"></div>
  </div>

</div>

<!-- DATABASE -->
<script src="data/username.js"></script>
<script src="data/pembagian-tugas.js"></script>

<script>
// ================= AMBIL USERNAME =================
const params = new URLSearchParams(window.location.search);
const username = params.get("username");

if(!username){
  alert("Username tidak ditemukan");
  window.location.href = "login.html";
}

// ================= DATA GURU =================
const guru = masterGuru.find(g => g.username === username);
document.getElementById("namaGuru").innerText = guru ? guru.nama : "-";
document.getElementById("nipGuru").innerText = guru ? guru.nip : "-";

// ================= DATA TUGAS =================
const dataTugas = pembagianTugas.filter(t => t.username === username);

const tbody = document.getElementById("tabelTugas");

let jpMengajar = 0;
let jpTambahan = 0;

dataTugas.forEach((t,i)=>{
  if(t.jenis === "mengajar"){
    jpMengajar += Number(t.jp);
  }else{
    jpTambahan += Number(t.jp);
  }

  tbody.innerHTML += `
    <tr>
      <td align="center">${i+1}</td>
      <td align="center">${t.jenis === "mengajar" ? "Mengajar" : "Tugas Tambahan"}</td>
      <td>${t.uraian}</td>
      <td>${t.kelas || "-"}</td>
      <td align="center">${t.jp}</td>
    </tr>
  `;
});

// ================= SUBTOTAL =================
document.getElementById("subtotalJP").innerHTML = `
  Jumlah JP Mengajar : ${jpMengajar} JP<br>
  Jumlah JP Tugas Tambahan : ${jpTambahan} JP<br>
  <b>Total Keseluruhan : ${jpMengajar + jpTambahan} JP</b>
`;

// AUTO PRINT (opsional)
// window.print();
</script>

</body>
</html>
